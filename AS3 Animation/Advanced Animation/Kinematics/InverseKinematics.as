package {	import flash.display.Sprite;	import flash.events.Event;	import flash.display.StageAlign;	import flash.display.StageScaleMode;		public class InverseKinematics extends Sprite {		private var segment:Segment;		private var segments:Array;		private var segmentNum:Number = 40;				public function InverseKinematics():void {			stage.align = StageAlign.TOP_LEFT;			stage.scaleMode = StageScaleMode.NO_SCALE;			init();		}				private function init():void {			segments = new Array();			for (var i:uint = 0; i< segmentNum; i++) {				segment = new Segment(80,18);				addChild(segment);				segments.push(segment);			}						stage.addEventListener(Event.ENTER_FRAME, onStartFrame);		}				private function onStartFrame(evt:Event):void {			dragSegment(segments[0], mouseX, mouseY);						for (var i:uint = 1; i< segments.length; i++) {				var segmentA:Segment = segments[i];				var segmentB:Segment = segments[i-1];				dragSegment(segmentA, segmentB.x, segmentB.y);			}		}				private function dragSegment(segment:Segment, xPos:Number, yPos:Number):void {			var dx:Number = xPos - segment.x;			var dy:Number = yPos - segment.y;			var angle:Number = Math.atan2(dy,dx);			segment.rotation = angle * 180 / Math.PI;						var segW:Number = segment.getPivot().x - segment.x;			var segH:Number = segment.getPivot().y - segment.y;			segment.x = xPos - segW;			segment.y = yPos - segH;		}	}}